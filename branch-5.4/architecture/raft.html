

<!DOCTYPE html>
<html class="no-js" lang="en" style="visibility: hidden;">
    
    

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>
             Raft Consensus Algorithm in ScyllaDB | ScyllaDB Docs 
        </title>
        <meta name="description" content="ScyllaDB is an Apache Cassandra-compatible NoSQL data store that can handle 1 million transactions per second on a single server." />
        <link rel="icon" href="../_static/img/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="../_static/img/favicon-32x32.png" sizes="32x32" />
        <link rel="icon" href="../_static/img/favicon-228x228.png" sizes="192x192" />
        <link rel="apple-touch-icon" href="../_static/img/favicon-228x228.png" />
        <meta name="msapplication-TileImage" href="../_static/img/favicon-228x228.png" />

        
            
            
        

        
            
            <link rel="canonical" href="https://opensource.docs.scylladb.com/stable/architecture/raft.html"/>
        

        <link rel="author" href="mailto:info@scylladb.com" />

        
            
        <!-- increase expertrec loading priority-->
        <link rel="dns-prefetch" href="https://cse.expertrec.com">

        <!-- increase font loading priority -->
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link rel="preload" as="style"
              href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- async CSS -->
        <link rel="stylesheet" media="print" onload="this.onload=null;this.removeAttribute('media');"
              href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />

        <!-- no-JS fallback -->
        <noscript>
            <link rel="stylesheet"
                  href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,400;0,500;0,700;1,400&display=swap" />
        </noscript>

        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/biel-search@latest/dist/biel-search/biel-search.css">
        <script type="module" src="https://cdn.jsdelivr.net/npm/biel-search@latest/dist/biel-search/biel-search.esm.js"></script>
        
        
        
            
                <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/css/main.css?v=e3ce25dc" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/sphinx_collapse.css?v=226d88b4" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
            
        
            
                <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=5a6d8084" />
            
        
    
        
        
    
    
    <meta name="robots" content="noindex">
    
    
            
        <script type="text/javascript" src="../_static/js/runtime.bundle.js"></script>
        <script type="text/javascript" src="../_static/js/main.bundle.js"></script>
        
            
                <script src="../_static/documentation_options.js?v=5929fcd5"></script>
            
        
            
                <script src="../_static/doctools.js?v=9a2dae69"></script>
            
        
            
                <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
            
        
            
                <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
            
        
            
                <script src="../_static/copybutton.js?v=f281be69"></script>
            
        
    
            
                <!-- Local meta tags -->
            
            
                <!-- Google Tag Manager docs -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-54NWVS4");
</script>
<!-- End Google Tag Manager -->

<!-- Google Tag Manager global -->
<script>
    (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            "gtm.start": new Date().getTime(),
            event: "gtm.js"
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, "script", "dataLayer", "GTM-T8P2JP");
</script>
<!-- End Google Tag Manager -->

<!-- Expertrec -->
<script>
    var id = "e2077224-9ccf-11e9-a0c9-0242ac130002";
    var ci_search = document.createElement("script");
    ci_search.type = "text/javascript";
    ci_search.async = true;
    ci_search.src = "https://cse.expertrec.com/api/js/ci_common.js?id=" + id;
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(ci_search, s);
</script>
<!-- End Expertrec -->
            
        

    </head>

    <body class="brand-open-source">
        <section class="promo-banner  promo-banner--hide" style="display: none;">
    <div class="promo-banner-wrapper">
        
        <div class="promo-banner__title">ScyllaDB University LIVE, FREE Virtual Training Event | March 21</div>
        <a class="promo-banner__button button button--reverse" href="https://lp.scylladb.com/university-live-2023-03-registration?siteplacement=docs"
           target="_blank" rel="noopener noreferrer">Register for Free</a>
        <button class="promo-banner__close">
            <i class="icon-cancel"></i>
        </button>
    </div>
</section>
        <header class="header">
    <div class="header-logo">
        <a class="header-logo__img" href="https://scylladb.com/">
            <img src="../_static/img/scylladb-logo-horizontal.svg" alt="ScyllaDB Documentation Logo" />
        </a>
        <span class="header-logo__bar"></span>
        <a class="header-logo__text" href="https://docs.scylladb.com/">
            Documentation
        </a>
    </div>
    <div class="header-navigation">
        <ul class="dropdown menu scylla-dropdown scylla-dropdown--header" data-dropdown-menu>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Deployments <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/scylla-cloud/">
                            <i class="icon-docs-cloud"></i>Cloud</a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/manual/">
                            <i class="icon-server"></i>Server</a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Tools <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://manager.docs.scylladb.com/">
                            <i class="icon-docs-manager"></i>ScyllaDB Manager</a>
                    </li>
                    <li>
                        <a href="https://monitoring.docs.scylladb.com/">
                            <i class="icon-docs-monitoring"></i>ScyllaDB
                            Monitoring Stack</a>
                    </li>
                    <li>
                        <a href="https://operator.docs.scylladb.com/">
                            <i class="icon-docs-operator"></i>ScyllaDB Operator
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Drivers <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://docs.scylladb.com/manual/stable/using-scylla/drivers/cql-drivers/">
                            <i class="icon-docs-nsql-guides"></i>CQL Drivers
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/manual/stable/using-scylla/drivers/dynamo-drivers/">
                            <i class="icon-docs-alternator"></i>DynamoDB Drivers
                        </a>
                    </li>
                </ul>
            </li>
            <li class="scylla-dropdown__item">
                <a href="#" class="scylla-dropdown__title">Resources
                    <i class="chevron icon-arrow-dropdown"></i></a>
                <ul class="menu scylla-dropdown__content">
                    <li>
                        <a href="https://university.scylladb.com">
                            <i class="icon-university"></i>
                            ScyllaDB University
                        </a>
                    </li>
                    <li>
                        <a href="https://forum.scylladb.com">
                            <i class="icon-docs-community"></i>
                            Community Forum
                        </a>
                    </li>
                    <li>
                        <a href="https://docs.scylladb.com/stable/get-started/develop-with-scylladb/tutorials-example-projects.html">
                            <i class="icon-docs-training"></i>
                            Tutorials
                        </a>
                    </li>
                </ul>
            </li>
        </ul>
        <div class="header-button">
            <a href="https://docs.scylladb.com/manual/stable/getting-started/installation-common/scylla-web-installer.html" class="button"><i class="icon-download me-2"></i> Install</a>
        </div>
    </div>
    <div class="header-search-box">
        <i class="dark-theme-toggler icon-theme"></i>
        <div class="search-box">
            <ci-search></ci-search>
        </div>
        
            <biel-button class="header-ask-ai" project="ddfdo8m94k" 
                header-title="ScyllaDB chatbot (beta)"
                button-position="default"
                modal-position="bottom-right"
                button-style="dark">
                Ask AI
            </biel-button>
        
    </div>
    <div class="side-nav-toggle">
    <i class="dark-theme-toggler icon-theme"></i>
    <div class="side-nav-toggle__button" data-toggle="side-nav">
        <i class="icon-menu"></i>
    </div>
</div>
</header>
        <div class="title"></div>
        <section
            class="layout  layout--sidebar layout--has-secondary-sidebar ">
            <div class="content large-order-2">
                
                    <div class="pre-content">
                        <div class="breadcrumbs">
    <span class="bread__item">
        <a href="https://docs.scylladb.com"
           class="bread__highlight">
            <i class="icon-home"></i> ScyllaDB Docs
        </a>
    </span>
    <span class="bread__item">
        <a href="../index.html"
           class="bread__highlight">
            ScyllaDB Open Source
        </a>
    </span>
    
        <span class="bread__item">
            <a href="index.html" class="bread__highlight">
                ScyllaDB Architecture
            </a>
        </span>
    
    <span class="bread__item bread__item--last">Raft Consensus Algorithm in ScyllaDB</span>
</div>
                    </div>
                
                
                <div class="sidebar-right-layout">
                    <div class="body-container">
                

                    <div class="content-body">
                        
                            
<div class="admonition caution">
    <p class="admonition-title">Caution</p>
    <p>
        You're viewing documentation for a previous version.
        <a href="https://docs.scylladb.com/manual/">Switch to the latest stable version.</a>
    </p>
</div>

                        
                        
                        <section id="raft-consensus-algorithm-in-scylladb">
<h1>Raft Consensus Algorithm in ScyllaDB<a class="headerlink" href="#raft-consensus-algorithm-in-scylladb" title="Link to this heading">¶</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">¶</a></h2>
<p>ScyllaDB was originally designed, following Apache Cassandra, to use gossip for topology and schema updates and the Paxos consensus algorithm for
strong data consistency (<a class="reference internal" href="../using-scylla/lwt.html"><span class="doc">LWT</span></a>). To achieve stronger consistency without performance penalty, ScyllaDB has turned to Raft - a consensus algorithm designed as an alternative to both gossip and Paxos.</p>
<p>Raft is a consensus algorithm that implements a distributed, consistent, replicated log across members (nodes). Raft implements consensus by first electing a distinguished leader, then giving the leader complete responsibility for managing the replicated log. The leader accepts log entries from clients, replicates them on other servers, and tells servers when it is safe to apply log entries to their state machines.</p>
<p>Raft uses a heartbeat mechanism to trigger a leader election. All servers start as followers and remain in the follower state as long as they receive valid RPCs (heartbeat) from a leader or candidate. A leader sends periodic heartbeats to all followers to maintain his authority (leadership). Suppose a follower receives no communication over a period called the election timeout. In that case, it assumes no viable leader and begins an election to choose a new leader.</p>
<p>Leader selection is described in detail in the <a class="reference external" href="https://raft.github.io/raft.pdf">Raft paper</a>.</p>
<p>ScyllaDB can use Raft to maintain schema updates in every node (see below). Any schema update, like ALTER, CREATE or DROP TABLE, is first committed as an entry in the replicated Raft log, and, once stored on most replicas, applied to all nodes <strong>in the same order</strong>, even in the face of a node or network failures.</p>
<p>Upcoming ScyllaDB releases will use Raft to guarantee consistent topology updates similarly.</p>
</section>
<section id="quorum-requirement">
<span id="raft-quorum-requirement"></span><h2>Quorum Requirement<a class="headerlink" href="#quorum-requirement" title="Link to this heading">¶</a></h2>
<p>Raft requires at least a quorum of nodes in a cluster to be available. If multiple nodes fail
and the quorum is lost, the cluster is unavailable for schema updates. See <a class="reference internal" href="#raft-handling-failures"><span class="std std-ref">Handling Failures</span></a>
for information on how to handle failures.</p>
<p>Note that when you have a two-DC cluster with the same number of nodes in each DC, the cluster will lose the quorum if one
of the DCs is down.
<strong>We recommend configuring three DCs per cluster to ensure that the cluster remains available and operational when one DC is down.</strong></p>
</section>
<section id="enabling-raft">
<span id="enabling-raft-existing-cluster"></span><h2>Enabling Raft<a class="headerlink" href="#enabling-raft" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In ScyllaDB 5.2 and ScyllaDB Enterprise 2023.1 Raft is Generally Available and can be safely used for consistent schema management.
It will get enabled by default when you upgrade your cluster to ScyllaDB 5.4 or 2024.1.
If needed, you can explicitly prevent it from getting enabled upon upgrade.</p>
<p>See <a class="reference internal" href="../upgrade/index.html"><span class="doc">the upgrade guide from 5.2 to 5.4</span></a> for details.</p>
</div>
<p>ScyllaDB Open Source 5.2 and later, and ScyllaDB Enterprise 2023.1 and later come equipped with a procedure that can setup Raft-based consistent cluster management in an existing cluster. We refer to this as the <strong>Raft upgrade procedure</strong> (do not confuse with the <a class="reference internal" href="../upgrade/index.html"><span class="doc">ScyllaDB version upgrade procedure</span></a>).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Once enabled, Raft cannot be disabled on your cluster. The cluster nodes will fail to restart if you remove the Raft feature.</p>
</div>
<p>To enable Raft in an existing cluster, you need to enable the <code class="docutils literal notranslate"><span class="pre">consistent_cluster_management</span></code> option in the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> file
for <strong>each node</strong> in the cluster:</p>
<ol class="arabic">
<li><p>Ensure that the schema is synchronized in the cluster by executing <a class="reference internal" href="../operating-scylla/nodetool-commands/describecluster.html"><span class="doc">nodetool describecluster</span></a> on each node and ensuring that the schema version is the same on all nodes.</p></li>
<li><p>Perform a <a class="reference internal" href="../operating-scylla/procedures/config-change/rolling-restart.html"><span class="doc">rolling restart</span></a>, updating the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> file for <strong>each node</strong> in the cluster before restarting it to enable the <code class="docutils literal notranslate"><span class="pre">consistent_cluster_management</span></code> option:</p>
<blockquote>
<div><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">consistent_cluster_management</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>When all the nodes in the cluster and updated and restarted, the cluster will start the <strong>Raft upgrade procedure</strong>.
<strong>You must then verify</strong> that the Raft upgrade procedure has finished successfully. Refer to the <a class="reference internal" href="#verify-raft-procedure"><span class="std std-ref">next section</span></a>.</p>
<p>Alternatively, you can enable the <code class="docutils literal notranslate"><span class="pre">consistent_cluster_management</span></code> option when you are:</p>
<ul class="simple">
<li><p>Performing a rolling upgrade from version 5.1 to 5.2 or version 2022.x to 2023.1 by updating <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> before restarting each node. The Raft upgrade procedure will start as soon as the last node was upgraded and restarted. As above, this requires <a class="reference internal" href="#verify-raft-procedure"><span class="std std-ref">verifying</span></a> that the procedure successfully finishes.</p></li>
<li><p>Creating a new cluster. This does not use the Raft upgrade procedure; instead, Raft is functioning in the cluster and managing schema right from the start.</p></li>
</ul>
<p>Until all nodes are restarted with <code class="docutils literal notranslate"><span class="pre">consistent_cluster_management:</span> <span class="pre">true</span></code>, it is still possible to turn this option back off. Once enabled on every node, it must remain turned on (or the node will refuse to restart).</p>
<section id="verifying-that-the-raft-upgrade-procedure-finished-successfully">
<span id="verify-raft-procedure"></span><h3>Verifying that the Raft upgrade procedure finished successfully<a class="headerlink" href="#verifying-that-the-raft-upgrade-procedure-finished-successfully" title="Link to this heading">¶</a></h3>
<p>The Raft upgrade procedure starts as soon as every node in the cluster restarts with <code class="docutils literal notranslate"><span class="pre">consistent_cluster_management</span></code> flag enabled in <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code>.</p>
<p>The procedure requires <strong>full cluster availability</strong> to correctly setup the Raft algorithm; after the setup finishes, Raft can proceed with only a majority of nodes, but this initial setup is an exception.
An unlucky event, such as a hardware failure, may cause one of your nodes to fail. If this happens before the Raft upgrade procedure finishes, the procedure will get stuck and your intervention will be required.</p>
<p>To verify that the procedure finishes, look at the log of every Scylla node (using <code class="docutils literal notranslate"><span class="pre">journalctl</span> <span class="pre">_COMM=scylla</span></code>). Search for the following patterns:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Starting</span> <span class="pre">internal</span> <span class="pre">upgrade-to-raft</span> <span class="pre">procedure</span></code> denotes the start of the procedure,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Raft</span> <span class="pre">upgrade</span> <span class="pre">finished</span></code> denotes the end.</p></li>
</ul>
<p>The following is an example of a log from a node which went through the procedure correctly. Some parts were truncated for brevity:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">features - Feature SUPPORTS_RAFT_CLUSTER_MANAGEMENT is enabled</span>
<span class="go">raft_group0 - finish_setup_after_join: SUPPORTS_RAFT feature enabled. Starting internal upgrade-to-raft procedure.</span>
<span class="go">raft_group0_upgrade - starting in `use_pre_raft_procedures` state.</span>
<span class="go">raft_group0_upgrade - Waiting until everyone is ready to start upgrade...</span>
<span class="go">raft_group0_upgrade - Joining group 0...</span>
<span class="go">raft_group0 - server 624fa080-8c0e-4e3d-acf6-10af473639ca joined group 0 with group id 8f8a1870-5c4e-11ed-bb13-fe59693a23c9</span>
<span class="go">raft_group0_upgrade - Waiting until every peer has joined Raft group 0...</span>
<span class="go">raft_group0_upgrade - Every peer is a member of Raft group 0.</span>
<span class="go">raft_group0_upgrade - Waiting for schema to synchronize across all nodes in group 0...</span>
<span class="go">raft_group0_upgrade - synchronize_schema: my version: a37a3b1e-5251-3632-b6b4-a9468a279834</span>
<span class="go">raft_group0_upgrade - synchronize_schema: schema mismatches: {}. 3 nodes had a matching version.</span>
<span class="go">raft_group0_upgrade - synchronize_schema: finished.</span>
<span class="go">raft_group0_upgrade - Entering synchronize state.</span>
<span class="go">raft_group0_upgrade - Schema changes are disabled in synchronize state. If a failure makes us unable to proceed, manual recovery will be required.</span>
<span class="go">raft_group0_upgrade - Waiting for all peers to enter synchronize state...</span>
<span class="go">raft_group0_upgrade - All peers in synchronize state. Waiting for schema to synchronize...</span>
<span class="go">raft_group0_upgrade - synchronize_schema: collecting schema versions from group 0 members...</span>
<span class="go">raft_group0_upgrade - synchronize_schema: collected remote schema versions.</span>
<span class="go">raft_group0_upgrade - synchronize_schema: my version: a37a3b1e-5251-3632-b6b4-a9468a279834</span>
<span class="go">raft_group0_upgrade - synchronize_schema: schema mismatches: {}. 3 nodes had a matching version.</span>
<span class="go">raft_group0_upgrade - synchronize_schema: finished.</span>
<span class="go">raft_group0_upgrade - Schema synchronized.</span>
<span class="go">raft_group0_upgrade - Raft upgrade finished.</span>
</pre></div>
</div>
<p>In a functioning cluster with good network connectivity the procedure should take no more than a few seconds.
Network issues may cause the procedure to take longer, but if all nodes are alive and the network is eventually functional (each pair of nodes is eventually connected), the procedure will eventually finish.</p>
<p>Note the following message, which appears in the log presented above:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Schema changes are disabled in synchronize state. If a failure makes us unable to proceed, manual recovery will be required.</span>
</pre></div>
</div>
<p>During the procedure, there is a brief window while schema changes are disabled. This is when the schema change mechanism switches from the older unsafe algorithm to the safe Raft-based algorithm. If everything runs smoothly, this window will be unnoticeable; the procedure is designed to minimize that window’s length. However, if the procedure gets stuck e.g. due to network connectivity problem, ScyllaDB will return the following error when trying to perform a schema change during this window:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Cannot perform schema or topology changes during this time; the cluster is currently upgrading to use Raft for schema operations.</span>
<span class="go">If this error keeps happening, check the logs of your nodes to learn the state of upgrade. The upgrade procedure may get stuck</span>
<span class="go">if there was a node failure.</span>
</pre></div>
</div>
<p>In the next example, one of the nodes had a power outage before the procedure could finish. The following shows a part of another node’s logs:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">raft_group0_upgrade - Entering synchronize state.</span>
<span class="go">raft_group0_upgrade - Schema changes are disabled in synchronize state. If a failure makes us unable to proceed, manual recovery will be required.</span>
<span class="go">raft_group0_upgrade - Waiting for all peers to enter synchronize state...</span>
<span class="go">raft_group0_upgrade - wait_for_peers_to_enter_synchronize_state: node 127.90.69.3 not in synchronize state yet...</span>
<span class="go">raft_group0_upgrade - wait_for_peers_to_enter_synchronize_state: node 127.90.69.1 not in synchronize state yet...</span>
<span class="go">raft_group0_upgrade - wait_for_peers_to_enter_synchronize_state: retrying in a while...</span>
<span class="go">raft_group0_upgrade - wait_for_peers_to_enter_synchronize_state: node 127.90.69.1 not in synchronize state yet...</span>
<span class="go">raft_group0_upgrade - wait_for_peers_to_enter_synchronize_state: retrying in a while...</span>
<span class="go">...</span>
<span class="go">raft_group0_upgrade - Raft upgrade procedure taking longer than expected. Please check if all nodes are live and the network is healthy. If the upgrade procedure does not progress even though the cluster is healthy, try performing a rolling restart of the cluster. If that doesn &#39;t help or some nodes are dead and irrecoverable, manual recovery may be required. Consult the relevant documentation.</span>
<span class="go">raft_group0_upgrade - wait_for_peers_to_enter_synchronize_state: node 127.90.69.1 not in synchronize state yet...</span>
<span class="go">raft_group0_upgrade - wait_for_peers_to_enter_synchronize_state: retrying in a while...</span>
</pre></div>
</div>
<p>Note the following message:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">raft_group0_upgrade - Raft upgrade procedure taking longer than expected. Please check if all nodes are live and the network is healthy. If the upgrade procedure does not progress even though the cluster is healthy, try performing a rolling restart of the cluster. If that doesn &#39;t help or some nodes are dead and irrecoverable, manual recovery may be required. Consult the relevant documentation.</span>
</pre></div>
</div>
<p>If the Raft upgrade procedure is stuck, this message will appear periodically in each node’s logs.</p>
<p>The message suggests the initial course of action:</p>
<ul class="simple">
<li><p>Check if all nodes are alive.</p></li>
<li><p>If a node is down but can be restarted, restart it.</p></li>
<li><p>If all nodes are alive, ensure that the network is healthy: that every node is reachable from every other node.</p></li>
<li><p>If all nodes are alive and the network is healthy, perform a <a class="reference internal" href="../operating-scylla/procedures/config-change/rolling-restart.html"><span class="doc">rolling restart</span></a> of the cluster.</p></li>
</ul>
<p>One of the reasons why the procedure may get stuck is a pre-existing problem in schema definitions which causes schema to be unable to synchronize in the cluster. The procedure cannot proceed unless it ensures that schema is synchronized.
If <strong>all nodes are alive and the network is healthy</strong>, you performed a rolling restart, but the issue still persists, contact <a class="reference external" href="https://www.scylladb.com/product/support/">ScyllaDB support</a> for assistance.</p>
<p>If some nodes are <strong>dead and irrecoverable</strong>, you’ll need to perform a manual recovery procedure. Consult <a class="reference internal" href="#recover-raft-procedure"><span class="std std-ref">the section about Raft recovery</span></a>.</p>
</section>
<section id="verifying-that-raft-is-enabled">
<h3>Verifying that Raft is enabled<a class="headerlink" href="#verifying-that-raft-is-enabled" title="Link to this heading">¶</a></h3>
<p>You can verify that Raft is enabled on your cluster by performing the following query on each node:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">cqlsh</span><span class="o">&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="k">system</span><span class="p">.</span><span class="n">scylla_local</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;group0_upgrade_state&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>The query should return:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go"> key                  | value</span>
<span class="go">----------------------+--------------------------</span>
<span class="go"> group0_upgrade_state | use_post_raft_procedures</span>

<span class="gp gp-VirtualEnv">(1 rows)</span>
</pre></div>
</div>
</div></blockquote>
<p>on every node.</p>
<p>If the query returns 0 rows, or <code class="docutils literal notranslate"><span class="pre">value</span></code> is <code class="docutils literal notranslate"><span class="pre">synchronize</span></code> or <code class="docutils literal notranslate"><span class="pre">use_pre_raft_procedures</span></code>, it means that the cluster is in the middle of the Raft upgrade procedure; consult the <a class="reference internal" href="#verify-raft-procedure"><span class="std std-ref">relevant section</span></a>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">value</span></code> is <code class="docutils literal notranslate"><span class="pre">recovery</span></code>, it means that the cluster is in the middle of the manual recovery procedure. The procedure must be finished. Consult <a class="reference internal" href="#recover-raft-procedure"><span class="std std-ref">the section about Raft recovery</span></a>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">value</span></code> is anything else, it might mean data corruption or a mistake when performing the manual recovery procedure. The value will be treated as if it was equal to <code class="docutils literal notranslate"><span class="pre">recovery</span></code> when the node is restarted.</p>
</section>
</section>
<section id="safe-schema-changes-with-raft">
<span id="raft-schema-changes"></span><h2>Safe Schema Changes with Raft<a class="headerlink" href="#safe-schema-changes-with-raft" title="Link to this heading">¶</a></h2>
<p>In ScyllaDB, schema is based on <a class="reference internal" href="../cql/ddl.html"><span class="doc">Data Definition Language (DDL)</span></a>. In earlier ScyllaDB versions, schema changes were tracked via the gossip protocol, which might lead to schema conflicts if the updates are happening concurrently.</p>
<p>Implementing Raft eliminates schema conflicts and allows full automation of DDL changes under any conditions, as long as a quorum
of nodes in the cluster is available. The following examples illustrate how Raft provides the solution to problems with schema changes.</p>
<ul>
<li><p>A network partition may lead to a split-brain case, where each subset of nodes has a different version of the schema.</p>
<blockquote>
<div><p>With Raft, after a network split, the majority of the cluster can continue performing schema changes, while the minority needs to wait until it can rejoin the majority. Data manipulation statements on the minority can continue unaffected, provided the <a class="reference internal" href="#raft-quorum-requirement"><span class="std std-ref">quorum requirement</span></a> is satisfied.</p>
</div></blockquote>
</li>
<li><p>Two or more conflicting schema updates are happening at the same time. For example, two different columns with the same definition are simultaneously added to the cluster. There is no effective way to resolve the conflict - the cluster will employ the schema with the most recent timestamp, but changes related to the shadowed table will be lost.</p>
<blockquote>
<div><p>With Raft, concurrent schema changes are safe.</p>
</div></blockquote>
</li>
</ul>
<p>In summary, Raft makes schema changes safe, but it requires that a quorum of nodes in the cluster is available.</p>
</section>
<section id="consistent-topology-with-raft-experimental">
<span id="raft-handling-failures"></span><span id="raft-topology-changes"></span><h2>Consistent Topology with Raft <span class="label label--caution">Experimental</span><a class="headerlink" href="#consistent-topology-with-raft-experimental" title="Link to this heading">¶</a></h2>
<p>ScyllaDB can use Raft to manage cluster topology. With Raft-managed topology
enabled, all topology operations are internally sequenced in a consistent
way. A centralized coordination process ensures that topology metadata is
synchronized across the nodes on each step of a topology change procedure.
This makes topology updates fast and safe, as the cluster administrator can
trigger many topology operations concurrently, and the coordination process
will safely drive all of them to completion. For example, multiple nodes can
be bootstrapped concurrently, which couldn’t be done with the old
gossip-based topology.</p>
<p>Support for Raft-managed topology is experimental and must be explicitly
enabled in the <code class="docutils literal notranslate"><span class="pre">scylla.yaml</span></code> configuration file by specifying
the <code class="docutils literal notranslate"><span class="pre">consistent-topology-changes</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">experimental_features</span><span class="p">:</span>
<span class="o">-</span> <span class="n">consistent</span><span class="o">-</span><span class="n">topology</span><span class="o">-</span><span class="n">changes</span>
</pre></div>
</div>
<p>As with other experimental features in ScyllaDB, you should not enable this
feature in production clusters due to insufficient stability. The feature
is undergoing backward-incompatible changes that may prevent upgrading
the cluster.</p>
</section>
<section id="handling-failures">
<h2>Handling Failures<a class="headerlink" href="#handling-failures" title="Link to this heading">¶</a></h2>
<p>Raft requires a quorum of nodes in a cluster to be available. If one or more nodes are down, but the quorum is live, reads, writes,
and schema updates proceed unaffected.
When the node that was down is up again, it first contacts the cluster to fetch the latest schema and then starts serving queries.</p>
<p>The following examples show the recovery actions depending on the number of nodes and DCs in your cluster.</p>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Cluster A: 1 datacenter, 3 nodes</span><a class="headerlink" href="#id1" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 40.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Failure</p></th>
<th class="head"><p>Consequence</p></th>
<th class="head"><p>Action to take</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1 node</p></td>
<td><p>Schema updates are possible and safe.</p></td>
<td><p>Try restarting the node. If the node is dead, <a class="reference internal" href="../operating-scylla/procedures/cluster-management/replace-dead-node.html"><span class="doc">replace it with a new node</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p>2 nodes</p></td>
<td><p>Data is available for reads and writes, schema changes are impossible.</p></td>
<td><p>Restart at least 1 of the 2 nodes that are down to regain quorum. If you can’t recover at least 1 of the 2 nodes, consult the <a class="reference internal" href="#recover-raft-procedure"><span class="std std-ref">manual Raft recovery section</span></a>.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Cluster B: 2 datacenters, 6  nodes (3 nodes per DC)</span><a class="headerlink" href="#id2" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 40.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Failure</p></th>
<th class="head"><p>Consequence</p></th>
<th class="head"><p>Action to take</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1-2 nodes</p></td>
<td><p>Schema updates are possible and safe.</p></td>
<td><p>Try restarting the node(s). If the node is dead, <a class="reference internal" href="../operating-scylla/procedures/cluster-management/replace-dead-node.html"><span class="doc">replace it with a new node</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p>3 nodes</p></td>
<td><p>Data is available for reads and writes, schema changes are impossible.</p></td>
<td><p>Restart 1 of the 3 nodes that are down to regain quorum. If you can’t recover at least 1 of the 3 failed nodes, consult the <a class="reference internal" href="#recover-raft-procedure"><span class="std std-ref">manual Raft recovery section</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>1DC</p></td>
<td><p>Data is available for reads and writes, schema changes are impossible.</p></td>
<td><p>When the DCs come back online, restart the nodes. If the DC fails to come back online and the nodes are lost, consult the <a class="reference internal" href="#recover-raft-procedure"><span class="std std-ref">manual Raft recovery section</span></a>.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Cluster C: 3 datacenter, 9  nodes (3 nodes per DC)</span><a class="headerlink" href="#id3" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 40.0%" />
<col style="width: 40.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Failure</p></th>
<th class="head"><p>Consequence</p></th>
<th class="head"><p>Action to take</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1-4 nodes</p></td>
<td><p>Schema updates are possible and safe.</p></td>
<td><p>Try restarting the nodes. If the nodes are dead, <a class="reference internal" href="../operating-scylla/procedures/cluster-management/replace-dead-node-or-more.html"><span class="doc">replace them with new nodes</span></a>.</p></td>
</tr>
<tr class="row-odd"><td><p>1 DC</p></td>
<td><p>Schema updates are possible and safe.</p></td>
<td><p>When the DC comes back online, try restarting the nodes in the cluster. If the nodes are dead, <a class="reference internal" href="../operating-scylla/procedures/cluster-management/add-dc-to-existing-dc.html"><span class="doc">add 3 new nodes in a new region</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>2 DCs</p></td>
<td><p>Data is available for reads and writes, schema changes are impossible.</p></td>
<td><p>When the DCs come back online, restart the nodes. If at least one DC fails to come back online and the nodes are lost, consult the <a class="reference internal" href="#recover-raft-procedure"><span class="std std-ref">manual Raft recovery section</span></a>.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="raft-manual-recovery-procedure">
<span id="recover-raft-procedure"></span><h3>Raft manual recovery procedure<a class="headerlink" href="#raft-manual-recovery-procedure" title="Link to this heading">¶</a></h3>
<p>The manual Raft recovery procedure applies to the following situations:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#verify-raft-procedure"><span class="std std-ref">The Raft upgrade procedure</span></a> got stuck because one of your nodes failed in the middle of the procedure and is irrecoverable,</p></li>
<li><p>or the cluster was running Raft but a majority of nodes (e.g. 2 our of 3) failed and are irrecoverable. Raft cannot progress unless a majority of nodes is available.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Perform the manual recovery procedure <strong>only</strong> if you’re dealing with <strong>irrecoverable</strong> nodes. If it is possible to restart your nodes, do that instead of manual recovery.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before proceeding, make sure that the irrecoverable nodes are truly dead, and not, for example, temporarily partitioned away due to a network failure. If it is possible for the ‘dead’ nodes to come back to life, they might communicate and interfere with the recovery procedure and cause unpredictable problems.</p>
<p>If you have no means of ensuring that these irrecoverable nodes won’t come back to life and communicate with the rest of the cluster, setup firewall rules or otherwise isolate your alive nodes to reject any communication attempts from these dead nodes.</p>
</div>
<p>During the manual recovery procedure you’ll enter a special <code class="docutils literal notranslate"><span class="pre">RECOVERY</span></code> mode, remove all faulty nodes (using the standard <a class="reference internal" href="../operating-scylla/procedures/cluster-management/remove-node.html"><span class="doc">node removal procedure</span></a>), delete the internal Raft data, and restart the cluster. This will cause the cluster to perform the Raft upgrade procedure again, initializing the Raft algorithm from scratch. The manual recovery procedure is applicable both to clusters which were not running Raft in the past and then had Raft enabled, and to clusters which were bootstrapped using Raft.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Entering <code class="docutils literal notranslate"><span class="pre">RECOVERY</span></code> mode requires a node restart. Restarting an additional node while some nodes are already dead may lead to unavailability of data queries (assuming that you haven’t lost it already). For example, if you’re using the standard RF=3, CL=QUORUM setup, and you’re recovering from a stuck of upgrade procedure because one of your nodes is dead, restarting another node will cause temporary data query unavailability (until the node finishes restarting). Prepare your service for downtime before proceeding.</p>
</div>
<ol class="arabic">
<li><p>Perform the following query on <strong>every alive node</strong> in the cluster, using e.g. <code class="docutils literal notranslate"><span class="pre">cqlsh</span></code>:</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="n">cqlsh</span><span class="o">&gt;</span> <span class="k">UPDATE</span> <span class="n">system</span><span class="mf">.</span><span class="n">scylla_local</span> <span class="k">SET</span> <span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;recovery&#39;</span> <span class="k">WHERE</span> <span class="k">key</span> <span class="o">=</span> <span class="s1">&#39;group0_upgrade_state&#39;</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p>Perform a <a class="reference internal" href="../operating-scylla/procedures/config-change/rolling-restart.html"><span class="doc">rolling restart</span></a> of your alive nodes.</p></li>
<li><p>Verify that all the nodes have entered <code class="docutils literal notranslate"><span class="pre">RECOVERY</span></code> mode when restarting; look for one of the following messages in their logs:</p>
<blockquote>
<div><div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">group0_client - RECOVERY mode.</span>
<span class="go">raft_group0 - setup_group0: Raft RECOVERY mode, skipping group 0 setup.</span>
<span class="go">raft_group0_upgrade - RECOVERY mode. Not attempting upgrade.</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Remove all your dead nodes using the <a class="reference internal" href="../operating-scylla/procedures/cluster-management/remove-node.html"><span class="doc">node removal procedure</span></a>.</p></li>
<li><p>Remove existing Raft cluster data by performing the following queries on <strong>every alive node</strong> in the cluster, using e.g. <code class="docutils literal notranslate"><span class="pre">cqlsh</span></code>:</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="n">cqlsh</span><span class="o">&gt;</span> <span class="k">TRUNCATE</span> <span class="k">TABLE</span> <span class="n">system</span><span class="mf">.</span><span class="n">discovery</span><span class="p">;</span>
<span class="n">cqlsh</span><span class="o">&gt;</span> <span class="k">TRUNCATE</span> <span class="k">TABLE</span> <span class="n">system</span><span class="mf">.</span><span class="n">group0_history</span><span class="p">;</span>
<span class="n">cqlsh</span><span class="o">&gt;</span> <span class="k">DELETE</span> <span class="n">value</span> <span class="k">FROM</span> <span class="n">system</span><span class="mf">.</span><span class="n">scylla_local</span> <span class="k">WHERE</span> <span class="k">key</span> <span class="o">=</span> <span class="s1">&#39;raft_group0_id&#39;</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p>Make sure that schema is synchronized in the cluster by executing <a class="reference internal" href="../operating-scylla/nodetool-commands/describecluster.html"><span class="doc">nodetool describecluster</span></a> on each node and verifying that the schema version is the same on all nodes.</p></li>
<li><p>We can now leave <code class="docutils literal notranslate"><span class="pre">RECOVERY</span></code> mode. On <strong>every alive node</strong>, perform the following query:</p>
<div class="highlight-cql notranslate"><div class="highlight"><pre><span></span><span class="n">cqlsh</span><span class="o">&gt;</span> <span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">system</span><span class="mf">.</span><span class="n">scylla_local</span> <span class="k">WHERE</span> <span class="k">key</span> <span class="o">=</span> <span class="s1">&#39;group0_upgrade_state&#39;</span><span class="p">;</span>
</pre></div>
</div>
</li>
<li><p>Perform a <a class="reference internal" href="../operating-scylla/procedures/config-change/rolling-restart.html"><span class="doc">rolling restart</span></a> of your alive nodes.</p></li>
<li><p>The Raft upgrade procedure will start anew. <a class="reference internal" href="#verify-raft-procedure"><span class="std std-ref">Verify</span></a> that it finishes successfully.</p></li>
</ol>
</section>
</section>
<section id="learn-more-about-raft">
<span id="raft-learn-more"></span><h2>Learn More About Raft<a class="headerlink" href="#learn-more-about-raft" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://raft.github.io/">The Raft Consensus Algorithm</a></p></li>
<li><p><a class="reference external" href="https://www.scylladb.com/tech-talk/achieving-nosql-database-consistency-with-raft-in-scylla/">Achieving NoSQL Database Consistency with Raft in ScyllaDB</a> - A tech talk by Konstantin Osipov</p></li>
<li><p><a class="reference external" href="https://www.scylladb.com/presentations/making-schema-changes-safe-with-raft/">Making Schema Changes Safe with Raft</a> - A Scylla Summit talk by Konstantin Osipov (register for access)</p></li>
<li><p><a class="reference external" href="https://www.scylladb.com/presentations/the-future-of-consensus-in-scylladb-5-0-and-beyond/">The Future of Consensus in ScyllaDB 5.0 and Beyond</a> - A Scylla Summit talk by Tomasz Grabiec (register for access)</p></li>
</ul>
</section>
</section>

                    </div>
                    
                        <div class="post-content">
                            
    <div class="feedback-container">
        <p class="feedback-container__title">Was this page helpful?</p>
        <span data-tooltip tabindex="1" title="Yes" data-position="top">
            <button class="feedback-container__button" id="feedback-positive">
                <i class="feedback-container__icon icon-docs-thumbs-up"></i>
            </button>
        </span>
        <span data-tooltip tabindex="1" title="No" data-position="top">
            <button class="feedback-container__button" id="feedback-negative">
                <i class="feedback-container__icon icon-docs-thumbs-down"></i>
            </button>
        </span>
        <div class="feedback-container__message" id="feedback-message"></div>
    </div>

    <script>
        function resetFeedbackButtonActive() {
            const feedbackButtons = document.getElementsByClassName('feedback-container__button');
            for (let i = 0; i < feedbackButtons.length; i++) {
                feedbackButtons[i].classList.remove('active');
            }
        }

        function showMessage(liked) {
            const feedbackMessage = document.getElementById('feedback-message');
            const themeGithubRepository = true;
            let message = 'Great! Thanks for your feedback.';
            if (themeGithubRepository && !liked) {
                message = "Thanks for your feedback! Please don't hesitate to <a href='https://github.com/scylladb/scylladb/issues/new?title=docs:%20Issue on page Raft Consensus Algorithm in ScyllaDB&&body=I%20would%20like%20to%20report%20an%20issue%20on%20page%20https://opensource.docs.scylladb.com/branch-5.4/architecture/raft%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation'>create an issue</a> if you have any suggestions on how we can improve.";
            }
            feedbackMessage.innerHTML = message;
        }

        function sendGaEvent(liked) {
            const event_label = liked ? "positive" : "negative";
            const event = "feedback_" + event_label;
            window.dataLayer = window.dataLayer || [];
            window.dataLayer.push({
                'event': event,
            });
        }

        const positiveFeebackButton = document.getElementById('feedback-positive');
        const negativeFeedbackButton = document.getElementById('feedback-negative');

        positiveFeebackButton.addEventListener('click', function() {
            resetFeedbackButtonActive();
            sendGaEvent(true);
            showMessage(true);
            positiveFeebackButton.classList.add('active');
        });

        negativeFeedbackButton.addEventListener('click', function() {
            resetFeedbackButtonActive();
            sendGaEvent(false);
            showMessage(false);
            negativeFeedbackButton.classList.add('active');
        });
    </script>

                            <div class="content-navigation">
    <div class="navigation navigation--prev">
        
            <a class="navigation__link" href="compaction/compaction-strategies.html">
                <button class="navigation__button">
                    <i class="icon-chevron-left"></i>
                </button>
                <div class="navigation__title">
                    <span class="colored">PREVIOUS</span> <br />Choose a Compaction Strategy
                </div>
            </a>
        
    </div>
    <div class="navigation navigation--next">
        
            <a class="navigation__link" href="../troubleshooting/index.html">
                <div class="navigation__title">
                    <span class="colored">NEXT</span> <br />Troubleshooting ScyllaDB
                </div>
                <button class="navigation__button">
                    <i class="icon-chevron-right"></i>
                </button>
            </a>
        
    </div>
</div>
                            <!-- Post content text -->
                        </div>
                    
                
                
                    </div>
                        <div class="sidebar-right large-order-3">
                            <div class="secondary-side-nav custom-scroll-bar">
    
    <ul class="contribute">
        <li class="contribute__item">
            <a class="button button-sm" href="https://github.com/scylladb/scylladb/issues/new?title=docs:%20Issue on page Raft Consensus Algorithm in ScyllaDB&&body=I%20would%20like%20to%20report%20an%20issue%20on%20page%20https://opensource.docs.scylladb.com/branch-5.4/architecture/raft%0A%0A%23%23%23%20Problem%0A%0A%23%23%23%20%20Suggest%20a%20fix&labels=documentation"
               target="_blank">
                <i class="icon-github" aria-hidden="true"></i>Create an issue
            </a>
        </li>
        
            <li class="contribute__item">
                <a class="button button-sm" href="https://github.com/scylladb/scylladb/edit/master/docs/architecture/raft.rst"
                   target="_blank">
                    <i class="icon-edit" aria-hidden="true"></i>Edit this page
                </a>
            </li>
        
    </ul>

    
        <div class="secondary-side-nav__content">
            <p class="topic-title">On this page</p>
            <ul>
<li><a class="reference internal" href="#">Raft Consensus Algorithm in ScyllaDB</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#quorum-requirement">Quorum Requirement</a></li>
<li><a class="reference internal" href="#enabling-raft">Enabling Raft</a><ul>
<li><a class="reference internal" href="#verifying-that-the-raft-upgrade-procedure-finished-successfully">Verifying that the Raft upgrade procedure finished successfully</a></li>
<li><a class="reference internal" href="#verifying-that-raft-is-enabled">Verifying that Raft is enabled</a></li>
</ul>
</li>
<li><a class="reference internal" href="#safe-schema-changes-with-raft">Safe Schema Changes with Raft</a></li>
<li><a class="reference internal" href="#consistent-topology-with-raft-experimental">Consistent Topology with Raft <span class="label label--caution">Experimental</span></a></li>
<li><a class="reference internal" href="#handling-failures">Handling Failures</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#raft-manual-recovery-procedure">Raft manual recovery procedure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#learn-more-about-raft">Learn More About Raft</a></li>
</ul>
</li>
</ul>

        </div>
    
</div>
                        </div>
                    </div>
                
            </div>
            <div class="sidebar-left  large-order-1">
                
                    
                        <div id="side-nav" class="side-nav custom-scroll-bar" data-closable data-toggler=".show">
    <button class="collapsible-button">
        <i class="icon-docs-menu-collapse"></i>
    </button>
    <div class="side-nav-content custom-scroll-bar">
        <div class="side-nav__title">
            <a href="../index.html">ScyllaDB Open Source</a>
        </div>
        <div class="side-nav__search">
            <div class="search-box">
                <ci-search></ci-search>
            </div>
        </div>
        <div class="side-nav__versions"><ul class="dropdown menu scylla-dropdown scylla-dropdown--versions" data-dropdown-menu>
    <li class="scylla-dropdown__item">
        <a class="scylla-dropdown__title" href="#">
            
                5.4
            
            <i class="chevron icon-docs-chevron-right"></i>
        </a>
        <ul class="menu scylla-dropdown__content">
            
                
                    <li>
                        <a href="../../stable/architecture/raft.html">6.2</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-6.1/architecture/raft.html">6.1</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-6.0/architecture/raft.html">6.0</a>
                    </li>
                
            
                
                    <li>
                        <a href="raft.html">5.4</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-5.2/architecture/raft.html">5.2</a>
                    </li>
                
            
                
                    <li>
                        <a href="../../branch-5.1/architecture/raft.html">5.1</a>
                    </li>
                
            
            
        </ul>
    </li>
</ul></div>
        <div class="side-nav__content">
            <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../getting-started/index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../getting-started/install-scylla/index.html">Install ScyllaDB</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/install-scylla/launch-on-aws.html">Launch ScyllaDB on AWS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/install-scylla/launch-on-gcp.html">Launch ScyllaDB on GCP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/install-scylla/launch-on-azure.html">Launch ScyllaDB on Azure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/installation-common/scylla-web-installer.html">ScyllaDB Web Installer for Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/install-scylla/install-on-linux.html">Install ScyllaDB Linux Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/installation-common/unified-installer.html">Install ScyllaDB Without root Privileges</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/installation-common/air-gapped-install.html">Air-gapped Server Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/installation-common/disable-housekeeping.html">ScyllaDB Housekeeping and how to disable it</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/installation-common/dev-mod.html">ScyllaDB Developer Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/configure.html">Configure ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/config-commands.html">ScyllaDB Configuration Reference</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../getting-started/requirements.html">ScyllaDB Requirements</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/system-requirements.html">System Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/os-support.html">OS Support by Linux Distributions and Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/cloud-instance-recommendations.html">Cloud Instance Recommendations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/scylla-in-a-shared-environment.html">ScyllaDB in a Shared Environment</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../using-scylla/migrate-scylla.html">Migrate to ScyllaDB</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/procedures/cassandra-to-scylla-migration-process.html">Migration Process from Cassandra to Scylla</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/cassandra-compatibility.html">Scylla and Apache Cassandra Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/mig-tool-review.html">Migration Tools Overview</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../using-scylla/integrations/index.html">Integration Solutions</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label for="toctree-checkbox-5"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-spark.html">Integrate Scylla with Spark</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-kairos.html">Integrate Scylla with KairosDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-presto.html">Integrate ScyllaDB with Presto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-elasticsearch.html">Integrate Scylla with Elasticsearch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-k8.html">Integrate Scylla with Kubernetes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-janus.html">Integrate Scylla with the JanusGraph Graph Data System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-datadog.html">Integrate Scylla with DataDog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-kafka.html">Integrate Scylla with Kafka</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-iota.html">Integrate Scylla with IOTA Chronicle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-spring.html">Integrate Scylla with Spring</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/sink-kafka-connector.html">Shard-Aware Kafka Connector for Scylla</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-ansible.html">Install Scylla with Ansible</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-databricks.html">Integrate Scylla with Databricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-jaeger.html">Integrate Scylla with Jaeger Server</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/integrations/integration-mindsdb.html">Integrate Scylla with MindsDB</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting-started/tutorials.html">Tutorials</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../operating-scylla/index.html">ScyllaDB for Administrators</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label for="toctree-checkbox-6"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../operating-scylla/admin.html">Administration Guide</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../operating-scylla/procedures/index.html">Procedures</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label for="toctree-checkbox-7"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/procedures/cluster-management/index.html">Cluster Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/procedures/backup-restore/index.html">Backup &amp; Restore</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/procedures/config-change/index.html">Change Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/procedures/maintenance/index.html">Maintenance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/procedures/tips/index.html">Best Practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/benchmarking-scylla.html">Benchmarking Scylla</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/procedures/cassandra-to-scylla-migration-process.html">Migrate from Cassandra to Scylla</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/installation-common/disable-housekeeping.html">Disable Housekeeping</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../operating-scylla/security/index.html">Security</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label for="toctree-checkbox-8"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/security-checklist.html">ScyllaDB Security Checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/authentication.html">Enable Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/runtime-authentication.html">Enable and Disable Authentication Without Downtime</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/create-superuser.html">Creating a Custom Superuser</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/gen-cqlsh-file.html">Generate a cqlshrc File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/password-reset.html">Reset Authenticator Password</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/enable-authorization.html">Enable Authorization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/authorization.html">Grant Authorization CQL Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/certificate-authentication.html">Certificate-based Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/rbac-usecase.html">Role Based Access Control (RBAC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/client-node-encryption.html">Encryption: Data in Transit Client to Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/node-node-encryption.html">Encryption: Data in Transit Node to Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/generate-certificate.html">Generating a self-signed Certificate Chain Using openssl</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/security/saslauthd.html">Configure SaslauthdAuthenticator</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../operating-scylla/admin-tools/index.html">Admin Tools</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label for="toctree-checkbox-9"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/nodetool.html">Nodetool Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cql/cqlsh.html">CQLSh</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/rest.html">REST</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/tracing.html">Tracing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin-tools/scylla-sstable.html">Scylla SStable</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin-tools/scylla-types.html">Scylla Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin-tools/sstableloader.html">SSTableLoader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin-tools/cassandra-stress.html">cassandra-stress</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin-tools/sstabledump.html">SSTabledump</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin-tools/sstable2json.html">SSTable2json</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin-tools/sstablemetadata.html">SSTableMetadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/logging.html">Scylla Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin-tools/perftune.html">Seastar Perftune</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin-tools/virtual-tables.html">Virtual Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin-tools/select-from-mutation-fragments.html">SELECT * FROM MUTATION_FRAGMENTS() Statement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://monitoring.docs.scylladb.com/">ScyllaDB Monitoring Stack</a></li>
<li class="toctree-l2"><a class="reference external" href="https://operator.docs.scylladb.com/">ScyllaDB Operator</a></li>
<li class="toctree-l2"><a class="reference external" href="https://manager.docs.scylladb.com/">ScyllaDB Manager</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../upgrade/index.html">Upgrade Procedures</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label for="toctree-checkbox-10"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/scylladb-versioning.html">ScyllaDB Versioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/upgrade-opensource/index.html">ScyllaDB Open Source Upgrade</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/upgrade-to-enterprise/index.html">ScyllaDB Open Source to ScyllaDB Enterprise Upgrade</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrade/ami-upgrade.html">ScyllaDB Image</a></li>
<li class="toctree-l3"><a class="reference external" href="https://enterprise.docs.scylladb.com/stable/upgrade/upgrade-enterprise/index.html">ScyllaDB Enterprise</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../operating-scylla/system-configuration/index.html">System Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label for="toctree-checkbox-11"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting-started/system-configuration.html">System Configuration Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/admin.html">scylla.yaml</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/system-configuration/snitch.html">ScyllaDB Snitches</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../operating-scylla/benchmarking-scylla.html">Benchmarking ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../operating-scylla/diagnostics.html">ScyllaDB Diagnostic Tools</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../using-scylla/index.html">ScyllaDB for Developers</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label for="toctree-checkbox-12"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../using-scylla/learn.html">Learn To Use ScyllaDB</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label for="toctree-checkbox-13"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference external" href="https://university.scylladb.com/">ScyllaDB University</a></li>
<li class="toctree-l3"><a class="reference external" href="https://university.scylladb.com/available-courses/">Course catalog</a></li>
<li class="toctree-l3"><a class="reference external" href="https://university.scylladb.com/courses/scylla-essentials-overview/">ScyllaDB Essentials</a></li>
<li class="toctree-l3"><a class="reference external" href="https://university.scylladb.com/courses/data-modeling/lessons/basic-data-modeling-2/">Basic Data Modeling</a></li>
<li class="toctree-l3"><a class="reference external" href="https://university.scylladb.com/courses/data-modeling/lessons/advanced-data-modeling/">Advanced Data Modeling</a></li>
<li class="toctree-l3"><a class="reference external" href="https://university.scylladb.com/courses/the-mutant-monitoring-system-training-course/">MMS - Learn by Example</a></li>
<li class="toctree-l3"><a class="reference external" href="https://iot.scylladb.com/">Care-Pet an IoT Use Case and Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../using-scylla/alternator/index.html">Scylla Alternator</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../using-scylla/features.html">Scylla Features</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label for="toctree-checkbox-14"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/features-open-source.html">Scylla Open Source Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/features-ent.html">Scylla Enterprise Features</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../using-scylla/drivers/index.html">Scylla Drivers</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label for="toctree-checkbox-15"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/drivers/cql-drivers/index.html">Scylla CQL Drivers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../using-scylla/drivers/dynamo-drivers/index.html">Scylla DynamoDB Drivers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../using-scylla/workload-attributes.html">Workload Attributes</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../cql/index.html">CQL Reference</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label for="toctree-checkbox-16"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../cql/cqlsh.html">CQLSh: the CQL shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/appendices.html">Appendices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/compaction.html">Compaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/consistency.html">Consistency Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/consistency-calculator.html">Consistency Level Calculator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/ddl.html">Data Definition</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cql/dml.html">Data Manipulation</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label for="toctree-checkbox-17"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../cql/dml/select.html">SELECT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cql/dml/insert.html">INSERT</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cql/dml/update.html">UPDATE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cql/dml/delete.html">DELETE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cql/dml/batch.html">BATCH</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cql/types.html">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/definitions.html">Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/secondary-indexes.html">Global Secondary Indexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/time-to-live.html">Expiring Data with Time to Live (TTL)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/functions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/wasm.html">Wasm support for user-defined functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/json.html">JSON Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/mv.html">Materialized Views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/non-reserved-keywords.html">Non-Reserved CQL Keywords</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/reserved-keywords.html">Reserved CQL Keywords</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cql/cql-extensions.html">ScyllaDB CQL Extensions</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">ScyllaDB Architecture</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label for="toctree-checkbox-18"><i class="icon-chevron-right"></i></label><div class="break"></div><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ringarchitecture/index.html">ScyllaDB Ring Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture-fault-tolerance.html">ScyllaDB Fault Tolerance</a></li>
<li class="toctree-l2"><a class="reference internal" href="console-CL-full-demo.html">Consistency Level Console Demo</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="anti-entropy/index.html">ScyllaDB Anti-Entropy</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label for="toctree-checkbox-19"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="anti-entropy/hinted-handoff.html">Scylla Hinted Handoff</a></li>
<li class="toctree-l3"><a class="reference internal" href="anti-entropy/read-repair.html">Scylla Read Repair</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operating-scylla/procedures/maintenance/repair.html">Scylla Repair</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="sstable/index.html">SSTable</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label for="toctree-checkbox-20"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="sstable/sstable2/index.html">ScyllaDB SSTable - 2.x</a></li>
<li class="toctree-l3"><a class="reference internal" href="sstable/sstable3/index.html">ScyllaDB SSTable - 3.x</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="compaction/compaction-strategies.html">Compaction Strategies</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Raft Consensus Algorithm in ScyllaDB</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting ScyllaDB</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label for="toctree-checkbox-21"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../troubleshooting/support/index.html">Errors and Support</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label for="toctree-checkbox-22"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/report-scylla-problem.html">Report a Scylla problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/error-messages/index.html">Error Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/log-level.html">Change Log Level</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../troubleshooting/startup/index.html">ScyllaDB Startup</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label for="toctree-checkbox-23"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/change-ownership.html">Ownership Problems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/scylla-wont-start.html">Scylla will not Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/python-error-no-module-named-yaml.html">Scylla Python Script broken</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../troubleshooting/upgrade/index.html">Upgrade</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label for="toctree-checkbox-24"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/missing-dotmount-files.html">Inaccessible configuration files after ScyllaDB upgrade</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../troubleshooting/cluster/index.html">Cluster and Node</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label for="toctree-checkbox-25"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/failed-decommission.html">Failed Decommission Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/timeouts.html">Cluster Timeouts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/node-joined-without-any-data.html">Node Joined With No Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/nodetool-memory-read-timeout.html">SocketTimeoutException</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/nodetool-nullpointerexception.html">NullPointerException</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/failed-schema-sync.html">Failed Schema Sync</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../troubleshooting/modeling/index.html">Data Modeling</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label for="toctree-checkbox-26"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/large-partition-table.html">Scylla Large Partitions Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/large-rows-large-cells-tables.html">Scylla Large Rows and Cells Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/debugging-large-partition.html">Large Partitions Hunting</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../troubleshooting/storage/index.html">Data Storage and SSTables</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" type="checkbox"/><label for="toctree-checkbox-27"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/space-up.html">Space Utilization Increasing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/drop-table-space-up.html">Disk Space is not Reclaimed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/sstable-corruption.html">SSTable Corruption Problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/pointless-compactions.html">Pointless Compactions</a></li>
<li class="toctree-l3"><a class="reference external" href="https://monitoring.docs.scylladb.com/stable/use-monitoring/advisor/heavyCompaction.html">Limiting Compaction</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../troubleshooting/CQL/index.html">CQL</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" type="checkbox"/><label for="toctree-checkbox-28"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/time-zone.html">Time Range Query Fails</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/copy-from-failed.html">COPY FROM Fails</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/clients-table.html">CQL Connection Table</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../troubleshooting/monitor/index.html">ScyllaDB Monitor and Manager</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" type="checkbox"/><label for="toctree-checkbox-29"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/manager-monitoring-integration.html">Manager and Monitoring integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/reverse-dns-sshd.html">Manager lists healthy nodes as down</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../kb/index.html">Knowledge Base</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" type="checkbox"/><label for="toctree-checkbox-30"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../kb/cdc-experimental-upgrade.html">Upgrading from experimental CDC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/compaction.html">Compaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/consistency.html">Consistency in ScyllaDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/count-all-rows.html">Counting all rows in a table is slow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/cqlsh-more.html">CQL Query Does Not Display Entire Result Set</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/cqlsh-results.html">When CQLSh query returns partial results with followed by “More”</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/custom-user.html">Run Scylla and supporting services as a custom user:group</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/customizing-cpuset.html">Customizing CPUSET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/decode-stack-trace.html">Decoding Stack Traces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/disk-utilization.html">Snapshots and Disk Utilization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/dpdk-hardware.html">DPDK mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/flamegraph.html">Debug your database with Flame Graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/gc-grace-seconds.html">How to Change gc_grace_seconds for a Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/gossip.html">Gossip in Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/increase-permission-cache.html">Increase Permission Cache to Avoid Non-paged Queries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/lwt-differences.html">How does Scylla LWT Differ from Apache Cassandra ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/map-cpu.html">Map CPUs to Scylla Shards</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/memory-usage.html">Scylla Memory Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/ntp.html">NTP Configuration for Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/perftune-modes-sync.html">Updating the Mode in perftune.yaml After a ScyllaDB Upgrade</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/posix.html">POSIX networking for Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/quiz-administrators.html">Scylla consistency quiz for administrators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/raid-device.html">Recreate RAID devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/rf-increase.html">How to Safely Increase the Replication Factor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/scylla-and-spark-integration.html">Scylla and Spark integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/scylla-limits-systemd.html">Increase Scylla resource limits over systemd</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/seed-nodes.html">Scylla Seed Nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/set-up-swap.html">How to Set up a Swap Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/snapshots.html">Scylla Snapshots</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/static-columns.html">Scylla payload sent duplicated static columns</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/stop-local-repair.html">Stopping a local repair</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/system-limits.html">System Limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/tombstones-flush.html">How to flush old tombstones from a table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/ttl-facts.html">Time to Live (TTL) and Compaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/unresponsive-nodes.html">Scylla Nodes are Unresponsive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/update-pk.html">Update a Primary Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/use-perf.html">Using the perf utility with Scylla</a></li>
<li class="toctree-l2"><a class="reference internal" href="../kb/yaml-address.html">Configure Scylla Networking with Multiple NIC/IP Combinations</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">Reference</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" type="checkbox"/><label for="toctree-checkbox-31"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/aws-images.html">AWS Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/configuration-parameters.html">Configuration Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/versions-matrix-enterprise-oss.html">ScyllaDB Enterprise vs. Open Source Matrix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">ScyllaDB FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">Contribute to ScyllaDB</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../alternator/alternator.html">Alternator: DynamoDB API in Scylla</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" type="checkbox"/><label for="toctree-checkbox-32"><i class="icon-chevron-right"></i></label><div class="break"></div><ul>
<li class="toctree-l2"><a class="reference internal" href="../alternator/getting-started.html">Getting Started With ScyllaDB Alternator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alternator/compatibility.html">ScyllaDB Alternator for DynamoDB users</a></li>
</ul>
</li>
</ul>

        </div>
    </div>
</div>
                    
                
            </div>
            
        </section>

        <footer class="footer">
    <div class="footer-group">
        <div class="footer-top">
            <a class="footer-logo" href="https://www.scylladb.com"></a>
            <div class="footer-links">
                <a class="footer-links__link" href="https://docs.scylladb.com/" target="_blank">Docs</a>
                <a class="footer-links__link" href="https://docs.scylladb.com/stable/get-started/develop-with-scylladb/tutorials-example-projects.html" target="_blank">Tutorials</a>
                <a class="footer-links__link" href="https://university.scylladb.com/" target="_blank">University</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/contact-us/"
                    target="_blank">Contact Us</a>
                <a class="footer-links__link" href="https://www.scylladb.com/company/" target="_blank">About Us</a>
            </div>
            <div class="footer-actions">
                <a class="footer-actions__link" href="http://slack.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="User Slack channel" data-position="bottom">
                        <i class="icon-slack"></i>
                    </span>
                </a>
                <a class="footer-actions__link" href="https://forum.scylladb.com/" target="_blank">
                    <span data-tooltip tabindex="1" title="Community forum" data-position="bottom">
                        <i class="icon-docs-community"></i>
                    </span>
                </a>
            </div>
        </div>

        
        <div class="footer-copyright">
            
                
                    &#169; 2025, ScyllaDB. All rights reserved.
                
                | <a class="footer-copyright__link" href="https://www.scylladb.com/tos/" target="_blank">Terms of Service</a>
                | <a class="footer-copyright__link" href="https://www.scylladb.com/privacy/" target="_blank">Privacy Policy</a>
                | ScyllaDB, and ScyllaDB Cloud, are registered trademarks of ScyllaDB, Inc.
            
        </div>
    


        <div class="footer-bottom">
            
                <div class="footer-bottom__last-updated">
                    
                        Last updated on 25 Oct 2025.
                    
                </div>
            
            <div class="footer-bottom__version">
                Powered by
                <a class="footer-bottom__link" href="http://sphinx-doc.org/">Sphinx 7.4.7</a> &amp;
                <a class="footer-bottom__link" href="https://sphinx-theme.scylladb.com/">ScyllaDB Theme 1.8.8</a>
            </div>
        </div>
    </div>
    
        <biel-button class="footer-ask-ai" project="ddfdo8m94k" 
            header-title="ScyllaDB chatbot (beta)"
            button-position="bottom-right"
            modal-position="bottom-right"
            button-style="dark">
            Ask AI
        </biel-button>
    
</footer>

        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T8P2JP" height="0" width="0"
                    style="display: none; visibility: hidden"></iframe>
        </noscript>
    </body>

</html>